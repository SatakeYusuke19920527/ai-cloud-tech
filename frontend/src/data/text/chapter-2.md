# 第 2 章　人工知能をめぐる動向

---

## 2-1探索・推論

### 迷路（探索木）

迷路のように分かれ道があり、スタートからゴールまでの経路を見つける問題は探索の問題と考えることができる。

このような問題を**コンピュータで処理するためには、最初に行うことを決め、次にどこを調べるかという手順を定める**必要がある。

分岐があるところと、行き止まりのところに注目すると、行き止まりのところに到達した場合には、別の分岐点に戻って探索を続ける。

迷路の道を取りまとめて、分岐点と通路の関係を構造として表すことができる。このような構造を**探索木**と呼ぶ。

![](tansaku.png=100x)

探索木をスタートからたどり、ゴールにたどり着く経路を探す。

探索木とは、要するに場合わけです。場合わけを続けていれば、いつか目的の条件に合致するものが出現するという考えを軸としている。

探索木は、探索する順序によって、見つかる経路や探索にかかる時間が変わる。

探索方法として、代表的なものに**幅優先探索**と**深さ優先探索**がある。

### 幅優先探索

幅優先探索では、出発点に近いノード（探索木の各要素）を順に探索する。

出発点から遠いノードほど後で探索される。

この方法では、**最短距離でゴールに到達する解**を見つけることができるが、探索の途中で記憶しておくノードが多くなり複雑になれば**メモリ不足**で処理が続行できなくなる可能性がある。

### 深さ優先探索

深さ優先探索では、1つのノードから行けるところまで進み、行き止まりになったら戻って別の経路を探索する。

この方法では、記憶しておくノードの数は少なく**メモリはあまり必要ない**が、最短距離の経路が見つかるとは限らない。

### ハノイの塔

探索を使って**ハノイの塔**というパズルを解くことができる。

このパズルは、3本のポールがあり、最初はすべて左側のポールに円盤が積み重なっている。

円盤は一度に1枚ずつしか移動させることができない。

また、小さな円盤の上に大きな円盤を置くことはできない。

このルールに従い、すべての円盤を右端のポールに移動できればパズルの完成である。

![](hanoi.png=100x)

（P,R,Q）は、一番小さい円盤がP、次の円盤がR、一番大きな円盤がQにある状態を表している。

このように、ハノイの塔の状態は円盤の位置の組として表現できる。

すべての円盤をルールに従って右側のポールに移動するパスは複数存在するが。最短で移動させるにはこの探索木の一番？？？側を選択すればよい。

### ロボットの行動計画

ロボットの行動計画は、探索を使って考えることができる。

このように、ロボットが目的を達成するまでの行動を考える技術を**プランニング**と呼ぶ。

ロボットがいる場所や、部屋が掃除されているかどうかなど、ロボットを取り巻く状況全体をまとめて1つの状態と考える。

そして、ある状態から別の状態へ変わることを、ロボットの行動として表す。

このようにして作られた、「状態」と「行動」のつながり全体を探索空間という。

部屋は2つあり、Room1 と Room2 としてロボットは、Room1 または Room2 のどちらかにいて、各部屋は「清掃済み」か「未清掃」のどちらかである
、という情報によって、状態が決まる。

最初、ロボットは清掃済みのRoom1にいて、ロボットは次の行動を取ることができる。

左に移動する

右に移動する

今いる部屋を清掃する

行動を行うと、ロボットの位置や部屋の状態が変わり、別の状態へ移る。

ロボットに「すべての部屋をできるだけ短い時間で清掃しなさい」という命令を与えた場合、探索によって目標とする状態に至る行動計画を求めることができる。

そのために、ロボットの行動を前提条件・行動・結果の3つで記述する。例えば、ロボットが清掃済みのRoom1にいる状態で右に移動すると、未清掃のRoom2にいる状態になる。

![](robotcleaning.png=100x)

また、ロボットが未清掃のRoom2にいる状態で清掃を行うと、その部屋は清掃済みの状態になる。このように、すべての状態について行動を記述しておくことで、目標状態に至る行動計画を立てることができる。

このような〈前提条件〉〈行動〉〈結果〉の組で行動を表す方法は、**STRIPS（Stanford Research Institute Problem Solver）**  と呼ばれている。

**SHRDLU**は、1968年から1970年にかけて**テリー・ウィノグラード**によって開発されたシステムである。SHRDLU では、「積み木の世界」と呼ばれる限られた世界を対象として、英語による指示を理解し、その指示に従って物体を操作することができた。積み木の世界には、立方体や四角錐などの物体があり、それらの位置関係が定義されている。

SHRDLU は、与えられた指示がその世界の中で実行可能かどうかを判断し、可能であれば実際に物体を動かすことができた。また、「どの物体がどこにあるか」といった質問に対して、現在の状態に基づいて答えることもできた。

このように SHRDLU は、限定された世界ではあるが、自然な会話をすることができた。この成果はの後に**Cyeプロジェクト**にも引き継がれている。


### ボードゲーム（オセロ・チェス・将棋・囲碁）

2016年，囲碁の世界トップ棋士に対して，人工知能プログラム AlphaGo（アルファ碁） が勝利し，大きな話題となった。

ボードゲームをコンピュータで解く基本は探索だが、その数が天文学的な数字になってしまうため、事実上すべてを探索しきれないという問題がある。

チェスや将棋ではすでにコンピュータが人間のトップレベルに達していたが，組み合わせの数が特に多い囲碁では困難と考えられており、トップレベルに達するには後10年以上はかかる

そこで、効率よく探索するため**コスト**の概念を取り入れる。

効率よく探索するため，経験的に有効な知識を用いることを
**ヒューリスティックな知識**（ここでの「ヒューリスティック」は「経験的な」「発見的な」という意味ではなく、「探索を効率化するのに有効な」という意味で呼んでいる）という。

ボードゲームの戦略決定には**Mini-Max法**が用いられる。

自分の番では，コストが最大になる手を選ぶ

相手の番では，コストが最小になる手を相手が選ぶ
探索
未来の局面から現在の局面に向けて逆算して，各ノードの値を決定し，
現在の局面で自分が選ぶべき最善手を求める方法。

Mini-Max法では探索量が膨大になるため，
不要な枝を調べないようにする方法として
**αβ法（アルファ・ベータ法）**が用いられる。

α値は自分側がこれ以上悪くならない下限値

β値は相手側がこれ以上良くならない上限値

探索の途中で，ある枝の評価がすでにαより悪いことが分かった場合，
その枝はそれ以上調べる必要がなくなる。
この打ち切りを**αカット**という。

同様にβによる打ち切りも行われる。

αβ法により，Mini-Max法と同じ最善手を保ったまま，
探索量を大幅に減らすことができる。

### モンテカルロ法

ただ囲碁や将棋などのボードゲームでは，どんなに工夫しても探索するノード数が非常に多く，すべての手を探索することは不可能である。

従来は，局面の良し悪しを人間が作った**ゲーム盤のスコア（コスト評価）**で判断していたが，囲碁ではそれがうまく機能しなかった。

そこで用いられたのが**モンテカルロ法**である。
これは，ある局面から先をランダムに最後まで打ち進めるシミュレーションを多数回行い、これを**プレイアウト**という。

黒の勝率

白の勝率

を統計的に求め，勝率の高い手を良い手と評価する方法である。

つまり，

局面の良し悪しを人間の知識で評価するのではなく，

「たくさん打って一番勝った手を選ぶ」

という考え方に基づく探索法である。

この方法により，9×9の囲碁では人間のプロ棋士と同程度の強さに達したが，19×19の囲碁では探索空間があまりにも大きく，可能な手をすべて調べる方法を**ブルートフォース（力任せ）**やモンテカルロ法だけでは限界があった。

最終的に，**ディープラーニングの技術**によって人間の思考パターンを学習した AlphaGo が，19×19の囲碁で世界トップ棋士に勝利することに成功した。

## 2-2 知識表現

### 人工無脳（知識なしでも知性があるように感じる人間心理の不思議）

**人工無脳**は，**チャットボット**，**おしゃべりボット**などと呼ばれている
コンピュータプログラムである。

人工無脳は，特定のルールや手順に従って会話を機械的に処理するだけであり，
実際には会話の内容を理解しているわけではないため，人工無脳と呼ばれている。

人工無脳の元祖は**イライザ（ELIZA）**と呼ばれるコンピュータプログラムであり，
1964年から1966年にかけて ジョセフ・ワイゼンバウム によって開発された。

このプログラムは，相手の発言をあらかじめ用意されたパターンと比較し，
パターンに合致した発言があると，
そのパターンに応じた発言を返答する仕組みになっている。

イライザは，自然な対話を人間を相手に行うことができ，
あたかも本物の人間と対話しているような錯覚に陥る。
このような現象を**イライザ効果**という。

イライザは基本的にオウム返しに相手の発言を再利用して発言するだけで，
相手の発言を理解しているわけではない。
しかし，人間はイライザが自分の発言を理解して応答していると思い込み，
対話に夢中になることがあった。

### 知識ベースの構築とエキスパートシステム

ある専門分野の知識を取り込み，
その分野のエキスパート（専門家）のように振る舞うプログラムを
**エキスパートシステム**と呼ぶ。

初期のエキスパートシステムとして最も影響力が大きかったのは，
1970年代にスタンフォード大学で開発された**マイシン（MYCIN）**である。

マイシンは，血液中のバクテリアの診断支援をするルールベースのプログラムであり，
約500のルールがあらかじめ用意されている。

質問に順番に答えていくことで，
感染した細菌を特定し，それに合った抗生物質を処方することができ，
あたかも感染症の専門医のように振る舞うことができた。

マイシンは69%の確率で正しい処方を行うことができ，
専門医の80%には及ばないものの，
専門医ではない医師よりはよい結果であった。

スタンフォード大学で実用指向のAIを推進してきた
エドワード・ファイゲンバウムは，
1960年代に未知の有機化合物を特定する**DENDRAL**という
エキスパートシステムを開発した。

1977年には，実世界の問題に対する技術を重視した
知識工学を提唱し，
1970年代後半から1980年代にかけて
多くのエキスパートシステムの開発が行われるようになった。

### 知識獲得のボトルネック（エキスパートシステムの限界）

知識ベースを構築するためには，
**専門家**，**ドキュメント**，**事例**などから
知識を獲得する必要がある。

しかし，専門家が持つ知識の多くは経験的なものであり，
**暗黙的**であるため，それを言語化してもらうことは困難であった。
それを自発的に述べてもらうことはほとんど不可能であり，
上手にヒアリングで取り出さなければならなく
このような事情から，
知識獲得のための知的な**インタビューシステム**などの研究も行われた。

また，獲得した知識の数が増えると，
矛盾や一貫性の問題が生じ，
**知識ベースを保守することが困難**になることも分かった。

このような問題を解決するため，
自然言語処理や機械学習を用いた知識獲得や，
意味ネットワークやオントロジーなどの研究が活発化した。

### 意味ネットワーク

**意味ネットワーク**（semantic network）は，もともと認知心理学における長期記憶の構造モデルとして考案されたものである。現在では，人工知能においても重要な知識表現の方法の1つとなっている。

意味ネットワークは，**概念**を**ラベルの付いたノード**で表し，概念の関係をラベルの付いたリンク（矢印）で結んだネットワークとして表現する。

重要な関係性として，**「is-a」の関係**（「〜である」の関係）と**継承関係**がある。
例えば，「動物は生物である」「哺乳類は動物である」といった関係を表現する。

このとき，矢印が向いている側が**上位概念**であり，矢印の始点が**下位概念**となる。
下位概念は，例外を指定しない限り，上位概念の属性をすべて引き継ぐ。

また，**「part-of」の関係**（「一部である」の関係）は属性を表し，
「目は頭部の一部である」「肉球は足の一部である」といった関係を表現する。

意味ネットワークは，人間にとって直感的で分かりやすく，さらに，ある概念に関する知識をリンクに基づいてたどることができるため，知識の検索も容易である。

### オントロジー（概念体系を記述するための方法）〔削減版〕

エキスパートシステムのような知識ベースのシステムが人間のような柔軟な知的能力を発揮するためには，広い範囲に及ぶ膨大な知識が必要である。この認識のもと，1984年にダグラス・レナートによって，**一般常識をコンピュータに取り込む**ことを目的とした**Cycプロジェクト**が開始された。

Cycプロジェクトでは，
「ビル・クリントンはアメリカ大統領の1人です」
「すべての木は植物です」
「パリはフランスの首都です」
といった一般常識を形式的に記述して入力していく。

例として，次のように表現される。

「ビル・クリントンはアメリカ大統領の1人です」
　（#$isa #$BillClinton #$UnitedStatesPresident）

「すべての木は植物です」
　（#$genls #$Tree-ThePlant #$Plant）

「パリはフランスの首都です」
　（#$capitalCity #$France #$Paris）

このプロジェクトが現在も進行中であることから，人間の一般常識がいかに膨大であり，それを形式的に記述することがいかに困難であるかが分かる。

このような知識の記述や共有の困難さを背景として，**知識を体系化する方法論**が研究されるようになり，**オントロジー**の研究が進められてきた。

**オントロジー**（ontology）は，本来は哲学用語で**存在論**（**存在に関する体系的理論**）を意味するが，人工知能分野では，トム・グルーバーによる
**「概念化の明示的な仕様」**
という定義が広く受け入れられている。

また，溝口理一郎は，オントロジーを，対象とする世界について「何が存在しているとみなすか」を明示的に示し，その結果得られた基本概念や概念間の関係を基にモデルを記述するための概念体系であると説明している。

オントロジーの目的は**知識の共有と活用**にあり，そのために，特定の領域で用いる
**「言葉（語句）」や「その意味」，および「それらの関係性」を，他の人とも共有できるように，明確な約束事（仕様）として定義**する。

意味ネットワークは概念と概念の関係を表現できるが，記述方法に関する統一的な約束事がないため，知識の共有や再利用が難しい。一方，オントロジーでは定義された仕様に基づいて知識を記述できるため，知識をつなげて利用することが容易になる。

### 概念間の関係（is-a と part-of の関係）
オントロジーにおいて，**概念間の関係**を表す
「is-a」の関係（「である」の関係） と
「part-of」の関係（「一部である」の関係）
は，特に重要である

「is-a」の関係は，**上位概念**と**下位概念**の関係を表し，**推移律**が成立するという特徴をもつ。
推移律とは，AとBに関係が成り立ち，BとCに関係が成り立っていれば，AとCにも自動的に関係が成り立つことである。

たとえば，
「乳類 is-a 動物」
「人間 is-a 乳類」
が成立していれば，
「人間 is-a 動物」
という関係も成立する。

このように，「is-a」の関係では推移律が成立する。

「part-of」の関係（「一部である」の関係）は，**全体と部分の関係**を表す。
たとえば，「日本 part-of アジア」，「東京 part-of 日本」という関係が成立していれば，「東京 part-of アジア」という関係も成立しそうに見える。

しかし，「part-of」の関係では，推移律が必ずしも成立するとは限らない。この点は重要である。

たとえば，「指 part-of 太郎」という関係と，「太郎 part-of 野球部」という関係が成立していても，「指 part-of 野球部」という関係は成立しない。
このように，「part-of」の関係には，推移律が成立する場合と成立しない場合がある。

「part-of」の**関係には，さまざまな種類**がある。
たとえば，「車輪 part-of 自転車」の場合，自転車から車輪を取り除くと自転車ではなくなるが，車輪は車輪のままである。この関係は，「指 part-of 太郎」と同様に，全体を文脈として部分の役割が決まる関係である。

一方，「太郎 part-of 野球部」という関係は，野球部に所属しているという文脈で成立するが，「指 part-of 太郎」という関係は，太郎の身体の一部であるという文脈で成立する。このように，文脈が異なると，関係は噛み合わなくなる。

さらに，
「木 part-of 森」の場合は，森から木を1本除いても森は森であり，木も木のままである。
しかし，「夫 part-of 夫婦」の場合は，夫が除かれると夫婦という関係自体が消滅する。
また，「ケーキの一片 part-of ケーキ全体」の場合は，切り分けた後も両方ともケーキであるが，「粘土 part-of 花瓶」の場合は，粘土が花瓶そのものであるため，粘土を取り除くと花瓶は消失してしまう。

このように，「part-of」の関係だけでも，**少なくとも5種類の異なる関係が存在**することが分かっている。
私たちはこれらの概念をほとんど意識せずに扱っているが，コンピュータにこれを理解させることは非常に難しい。現在も，これらの関係を厳密にモデル化するための研究が進められているが，決定的なツールはまだ存在していない。